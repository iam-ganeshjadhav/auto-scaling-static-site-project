stage('Find EC2 Instances in ASG') {
    steps {
        withAWS(credentials: 'awscreds', region: 'ap-south-1') {
            script {
                INSTANCES = sh(
                    script: """
                        aws autoscaling describe-auto-scaling-groups \
                        --auto-scaling-group-names auto-scaling-static-site-asg \
                        --query "AutoScalingGroups[0].Instances[*].InstanceId" \
                        --output text
                    """,
                    returnStdout: true
                ).trim()

                echo "Instances found: ${INSTANCES}"
            }
        }
    }
}
